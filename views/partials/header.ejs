<head>
  <!-- Bootstrap CSS -->
  <link
    rel="stylesheet"
    href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css"
  />
  <!-- jQuery and Bootstrap Bundle (includes Popper.js) -->
  <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.4.4/dist/umd/popper.min.js"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
</head>

<nav class="navbar navbar-expand-lg navbar-light bg-light">
  <div class="container">
    <!-- 로고 이미지 링크 -->
    <a href="/" class="navbar-brand">
      <img class="ci" src="/images/CI2.png" alt="logo" width="250">
    </a>
    <div class="collapse navbar-collapse" id="navbarNav">
      <ul class="navbar-nav ml-auto align-items-center">
        <!-- My Page 링크 -->
        <li class="nav-item" id="mypage" style="display: none;">
          <p class="mb-0 mr-3">
            <a href="/mypage" class="text-dark" style="text-decoration: none;">My page</a>
          </p>
        </li>
        <!-- 로그인 링크 -->
        <!-- id, aria-current 추가 -->
        <li class="nav-item" id="login">
          <a class="nav-link active" aria-current="page" href="/login">Login</a>
        </li>
        <!-- displayName -->
        <!-- 2024-12-24 이희범 현 사용자 이름 출력 추가 -->
        <li class="nav-item" id="displayName" style="display: none;">
          <a href="#" aria-current="page" class="nav-link active">현사용자이름출력자리</a>
        </li>
        <!-- 회원가입 버튼 -->
        <!-- id, aria-current 추가 -->
        <li class="nav-item" id="signup">
          <a class="nav-link btn btn-dark text-white" href="/signup">signup</a>
        </li>
        <!-- 로그아웃 버튼 -->
        <!-- id, style, aria-current 추가 -->
        <li class="nav-item" id="logout" style="display: none;">
          <a class="nav-link active" aria-current="page" href="#">Logout</a>
      </ul>
    </div>
  </div>
</nav>

<!-- jQuery (로그아웃 폼 이벤트를 위해 사용) -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

<!-- client.js에 구현된 로그아웃 함수 호출 -->
<script type="module">
  import { fetchFirebaseConfig, logout } from "/javascript/client.js"

  (async () => {
    // 1) Firebase 설정 받아와서 initializeApp
    await fetchFirebaseConfig();

    // 2) 로그아웃 폼 이벤트 등록 (getAuth(app)가 이제 정상 동작)
    logout();
  })();

  /* 2024-12-24 이희범 dispalyName 값 적용 및 수정 */
  // 로그인 상태 확인
  const uid = localStorage.getItem("uid");
  const email = localStorage.getItem("email");
  const displayName = localStorage.getItem("displayName");

  console.log(`로그인 상태 확인: uid=${uid}, email=${email}, displayName=${displayName}`);

  if (email) {
    console.log("로그인 상태 감지: 헤더 메뉴 업데이트 실행");

    // 헤더 메뉴 표시 상태 업데이트
    $("#login, #signup").hide(); // 로그인 전 버튼 숨기기
    $("#logout, #mypage, #displayName").show(); // 로그인 후 버튼 활성화
    $("#displayName a").html(`${displayName}님 환영합니다!`); // 디스플레이 이름 설정
  }
</script>