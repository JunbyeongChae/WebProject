<!-- views/pages/login.ejs -->

<style>
  html, body {
    height: 100%;
    margin: 0;
    padding: 0;
    overflow: hidden; 
  }
</style>

<%- include('../partials/header') %>

<!-- CSS 파일 포함 -->
<link rel="stylesheet" href="/stylesheets/style.css">

<div  id="content-wrapper" class="container my-5">
  <div class="row justify-content-center">
    <div class="col-md-6">
      <!-- 로고 -->
      <div class="text-center mb-4">
        <img src="/images/CI.png" alt="Logo" class="mb-3" width="150">
        <h3>Sign in to your account</h3>
      </div>

      <!-- 로그인 폼 -->
      <!-- form태그에 id를 추가 -->
      <form id="frm"> <!-- 폼 시작 -->
        <div class="form-group mb-3">
          <label for="email" style="position: relative; top: 1px; left: 140px;">E-mail</label>
          <input type="email" class="form-control" id="email" placeholder="Insert your email" style="width: 70%; margin: 0 auto;">
        </div>
        <div class="form-group mb-3">
          <label for="password" style="position: relative; top: 1px; left: 140px;">Password</label>
          <input type="password" class="form-control" id="password" name="password" placeholder="Enter your password" style="width: 70%; margin: 0 auto;">
        </div>
        <button type="submit" class="btn btn-dark border" style="width: 70%; display: block; margin: 10px auto;">Login</button>
      </form>

      <!-- 소셜 로그인 -->
      <div class="text-center mb-4">
        <p>Sign in with</p>
        <button id="googleLoginBtn" class="btn btn-light border" style="width: 70%; display: block; margin: 10px auto;">
          <img src="https://developers.google.com/identity/images/g-logo.png" alt="Google Logo" width="20" class="mr-2">
          Sign in with Google
        </button>
      </div>

      <!-- 회원가입 링크 -->
      <div class="text-center mt-4">
        <p>Don't have an account? <a href="/signup">Sign up</a></p>
        <p>Forgot your account or password? <a href="#">Find it</a></p>
      </div>
    </div>
  </div>
</div>

<%- include('../partials/footer') %>

<!-- jQuery (로그인 폼 이벤트를 위해 사용) -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

<!-- client.js에 구현된 로그인 함수 호출 -->
<script type="module">
  import { fetchFirebaseConfig, login } from "/javascript/client.js";

  (async () => {
    // 1) Firebase 설정 받아와서 initializeApp
    await fetchFirebaseConfig();

    // 2) 로그인 폼 이벤트 등록 (getAuth(app)가 이제 정상 동작)
    login();
  })();
</script>

<script type="module">
  import { login, googleLogin } from "/javascript/client.js";

  document
    .getElementById("googleLoginBtn")
    .addEventListener("click", googleLogin);
</script>