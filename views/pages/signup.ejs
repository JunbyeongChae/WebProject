<!-- views/pages/signup.ejs -->

<style>
  html, body {
    height: 100%;
    margin: 0;
    padding: 0;
    overflow: hidden; 
  }
</style>

<%- include('../partials/header') %>

<!-- CSS 파일 포함 -->
<link rel="stylesheet" href="/stylesheets/style.css">

<div id="content-wrapper" class="container my-5">
  <div class="row justify-content-center mb-1">
    <div class="col-md-6">
        <!-- 프로필 사진 등록 -->
        <div class="text-center mb-4">
          <img id="profilePreview" src="https://placehold.co/120x120" alt="Profile Image" class="rounded-circle" />
          <input type="file" id="profileImage" accept="image/*" class="d-none" />
          <small class="form-text text-muted">Click on the image to upload your profile picture.</small>
        </div>

      <!-- 회원가입 폼 -->
      <form id="signupForm">
        <div class="form-group mb-3">
          <label for="name" style="position: relative; top: 1px; left: 140px;">Name</label>
          <input style="width: 70%; margin: 0 auto;"
            type="text"
            class="form-control"
            id="name"
            placeholder="Enter your name"
          />
        </div>
        <div class="form-group mb-3">
          <label for="email" style="position: relative; top: 1px; left: 140px;">Email address</label>
          <input style="width: 70%; margin: 0 auto;"
            type="email"
            class="form-control"
            id="email"
            placeholder="Enter your email"
          />
        </div>
        <div class="form-group mb-3">
          <label for="password" style="position: relative; top: 1px; left: 140px;">Password</label>
          <input style="width: 70%; margin: 0 auto;"
            type="password"
            class="form-control"
            id="password"
            placeholder="Enter your password"
          />
        </div>
        <div class="form-group mb-3">
          <label for="confirmPassword" style="position: relative; top: 1px; left: 140px;">Confirm Password</label>
          <input style="width: 70%; margin: 0 auto;"
            type="password"
            class="form-control"
            id="confirmPassword"
            placeholder="Confirm your password"
          />
        </div>
        <!-- 전화번호 입력란 추가 -->
        <div class="form-group mb-3">
          <label for="phoneNumber" style="position: relative; top: 1px; left: 140px;">Phone Number</label>
          <input type="text" class="form-control" id="phoneNumber" placeholder="Enter phone number" style="width: 70%; margin: 0 auto;" required>
        </div>
        <button type="submit" class="btn btn-dark" style="width: 70%; display: block; margin: 10px auto;">
          Sign Up
        </button>
      </form>

      <!-- 로그인 링크 -->
      <div class="text-center">
        <p>Already have an account? <a href="/login">Log in</a></p>
      </div>
    </div>
  </div>
</div>

<%- include('../partials/footer') %>

<!-- 로그인, 회원가입에 jQuery문법을 사용하셔서 아래 사항 추가해놓았습니다!! -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

<script type="module">
  import {
    fetchFirebaseConfig,    // Firebase 초기화 함수
    initializeSignupPage,   // 페이지 초기화 함수 (폼 검증 등)
    signup,                  // 회원가입 함수
    PreviewImage            // 프로필 이미지 미리보기 함수
    } from "/javascript/client.js";

  (async () => {
    // 1) Firebase 설정 먼저 로드 + 초기화
    await fetchFirebaseConfig();
    
    document.getElementById("profilePreview").addEventListener("click", () => {
      document.getElementById("profileImage").click();
    });

    document.getElementById("profileImage").addEventListener("change", PreviewImage);

    // 2) 그 다음에 폼 이벤트를 바인딩 (signup)
    signup();

    // 3) 필요하다면 페이지 초기화
    initializeSignupPage();
  })();
</script>
